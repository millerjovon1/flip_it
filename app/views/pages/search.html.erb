<div class="d-flex justify-content-center">
  <div class="filter-container bg-white">
    <div class="row">
      <div class="col-sm-8 mt-5">
        <%= form_with url: search_path, method: :get do %>
          GENRE
          <fieldset class="form-group check_boxes optional snippet_tags">
            <% Song::GENRES.each do |genre| %>
              <div class="tag-item">
                <input class="form-check-input check_boxes optional tag-selector" type="checkbox" value="1" name="query[]" id="snippet_tag_ids_<%= genre %>">
                <label class="form-check-label collection_check_boxes" for="snippet_tag_ids_<%= genre %>"><%= genre %></label>
              </div>
            <% end %>
          </fieldset>
          INSTRUMENTS
          <fieldset class="form-group check_boxes optional snippet_tags">
            <% Song::INSTRUMENTS.each do |instrument| %>
              <div class="tag-item">
                <input class="form-check-input check_boxes optional tag-selector" type="checkbox" value="1" name="query[]" id="snippet_tag_ids_<%= instrument %>">
                <label class="form-check-label collection_check_boxes" for="snippet_tag_ids_<%= instrument %>"><%= instrument %></label>
              </div>
            <% end %>
          </fieldset>
        <% end %>
      </div>
    </div>
    <div>
      <%= submit_tag "DIG", name: "", class: "filter-button" %> </div>
  </div>
  <div class="result-container ">
    <div class= "song-container flex-grow-2 mt-5">
      <% @sorted_results[Song]&.each do |song| %>
        <div class="song-card">
          <img src=  " <%=song.photo.attached? ? cl_image_path(song.photo.key) : "https://source.unsplash.com/random/?<#{song.title.gsub(" ", " ")}" %> " alt="" class="songs-image">
          <div class="song-card-infos">
            <h3> <%= song.user.artist_name%></h3>
            <h2> <%= song.title%></h2>
            <p> #<%= song.genre%> <strong> <%= song.bpm%></strong> #<%= song.instruments%></p>
            <%= render 'songs/download_button', song: song %>
            <button data-action="click->playlist-popup#appear" class='btn btn-primary'>add</button>
          </div>
          <audio controls>
            <source src="<%=song.audio_file.url %>" type="audio/wav">
          </audio>
        </div>
        <a href="<%=song.audio_file.url %>" download></a>
      <% end %>
    </div>
    <div class="crate-container mt-5">
      <%  @sorted_results[Crate]&.each do |crate|%>
        <div class="crates-category" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url(<%= crate.photo.attached? ? cl_image_path(crate.photo.key) : "https://source.unsplash.com/random/?<#{crate.name.gsub(" ", " ")}" %> " alt="" class="songs-image">
          <%= link_to crate.name, crate_path(crate), class: "text-decoration-none text-white"%>
        <% end %>
      </div>
    </div>
  </div>
