<div class="row d-flex">
  <div class="col-4">
    <div class="filter-container bg-white">
      <%= form_with url: search_path, method: :get do %>
        GENRE
        <fieldset class="form-group check_boxes optional snippet_tags mt-1 mb-2">
          <% Song::GENRES.each do |genre| %>
            <div class="tag-item">
              <input class="form-check-input check_boxes optional tag-selector" type="checkbox" value="<%=genre%>" name="query[]" id="snippet_tag_ids_<%= genre %>">
              <label class="form-check-label collection_check_boxes" for="snippet_tag_ids_<%= genre %>"><%= genre %></label>
            </div>
          <% end %>
        </fieldset>
        INSTRUMENTS
        <fieldset class="form-group check_boxes optional snippet_tags mt-1 mb-2">
          <% Song::INSTRUMENTS.each do |instrument| %>
            <div class="tag-item">
              <input class="form-check-input check_boxes optional tag-selector" type="checkbox" value="<%=instrument%>" name="query[]" id="snippet_tag_ids_<%= instrument %>">
              <label class="form-check-label collection_check_boxes" for="snippet_tag_ids_<%= instrument %>"><%= instrument %></label>
            </div>
          <% end %>
        </fieldset>
        <%= submit_tag "DIG", name: "", class: "filter-button" %>
      <% end %>
    </div>
  </div>
  <div class="col-8">
    <div class= "song-container flex-grow-2 mt-5">
      <% @sorted_results[Song]&.each do |song| %>
        <div data-controller="playlist-popup">
          <div data-controller="play-button">
            <div class="song-card" >
              <div class="mx-3">
                <i class="fa-regular fa-circle-play play-button" style="color: #000000;" data-action="click->play-button#play" data-play-button-target="playButton"></i>
                <i class="fa-regular fa-circle-pause pause-button d-none" style="color: #000000;" data-action="click->play-button#pause" data-play-button-target="pauseButton"></i>
              </div>
              <div class="song-card-infos" style="background-image: linear-gradient(rgba(0,0,0,0.4),rgba(0,0,0,0.4)), url(<%=song.photo.attached? ? cl_image_path(song.photo.key) : "https://source.unsplash.com/random/?#{song.title.gsub(" ", " ")}" %>)" >
                <h3><strong> Artist:</strong> <%= song.user.artist_name%></h3>
                <h3 class= "text-nowrap"> bpm: <%= song.bpm%>
                  <br>
                  <strong>Genre:</strong>
                  <%= song.genre%>
                  <br>
                  <strong>Instruments:</strong> <%= song.instruments%></h3>
              </div>
              <div class="song-audio">
                <audio controls style="display: none" data-play-button-target="audio">
                  <source src="<%=song.audio_file.url %>" type="audio/wav" >
                </audio>
              </div>
              <div class="song-engagement">
                <h3>Title:<%= song.title%></h3>
                <%= render 'songs/download_button', song: song %>
                <i class="fa-solid fa-circle-plus card-buttons" data-action="click->playlist-popup#appear"> </i>
              </div>
            </div>
            <%= render 'songs/playlist_form', song: song, crate_song: @crate_song %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
<div class ="row">
  <div class="col">
    <div class="crate-container mt-5">
      <%  @sorted_results[Crate]&.each do |crate|%>
        <div class="crates-category" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url(<%= crate.photo.attached? ? cl_image_path(crate.photo.key) : "https://source.unsplash.com/random/?#{crate.name.gsub(" ", " ")}" %>)" alt="" class="songs-image">
          <%= link_to crate.name, crate_path(crate), class: "text-decoration-none text-white"%>
        </div>
      <% end %>
    </div>
  </div>
  <div class="col">
    <div class="artist-container mt-5">
      <%  @sorted_results[User]&.each do |user|%>
        <div class="artist-category" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url(<%= user.photo.attached? ? cl_image_path(user.photo.key) : "https://source.unsplash.com/random/?#{user.artist_name.gsub(" ", " ")}" %>)" alt="" class="songs-image">
          <%= link_to user.artist_name, user_path(user), class: "text-decoration-none text-white"%>
        </div>
      <% end %>
    </div>
  </div>
</div>
